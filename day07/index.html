<!DOCTYPE html>
<html lang="hu">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DAY07 lista n√©zet</title>

  <link rel="stylesheet" href="../assets/css/style.css">

  <!-- Leaflet (CSAK HOZZ√ÅADVA) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body.day07 {
      background: url("images/DAY07_01_Vierwaldstattersee_Meggen.jpg") center / cover no-repeat fixed;
    }

    .card {
      background: rgba(0, 0, 0, 0.72);
    }

    /* --- SZ√ÅMOZOTT K√âK POI JEL√ñL≈ê (CSAK HOZZ√ÅADVA) --- */
    .poi-numbered-icon {
      background: transparent;
      border: none;
    }

    .poi-numbered-icon svg {
      display: block;
    }
  </style>
</head>

<body class="day07">
  <div class="page">

    <!-- TOPBAR -->
    <div class="topbar">
      <div class="inner">
        <div class="brand">
          <div class="title">K√©k Duna t√∫ra</div>
          <div class="subtitle">DAY07 lista n√©zet</div>
        </div>
        <div class="btnrow">
          <a class="btn" href="../index.html">üè† F≈ëoldal</a>
          <button class="btn btn-accent" id="btnNearest">üìå Legk√∂zelebbi pont</button>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="card">
        <div class="h1">DAY07 ‚Äì Sv√°jc tavait√≥l Tirolig</div>
        <div class="small">
          A m√©r√©s automatikusan indul oldalnyit√°skor, majd 5 mp m√∫lva friss√≠t.
          A t√°vols√°gok minden c√©lpontn√°l friss√ºlnek.
        </div>
        <div class="notice" id="gpsNotice" style="display:none">
          A helymeghat√°roz√°s nem √©rhet≈ë el. Ellen≈ërizd az enged√©lyeket.
        </div>
      </div>

      <div style="height:14px"></div>

      <div class="grid" id="poiList">

        <!-- P1 -->
        <div class="poi" id="p1">
          <div class="poi-head">
            <div class="poi-title">1. Vierwaldst√§ttersee, Meggen</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p1"></span><span data-badgetext="p1">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p1">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">A Luzerni t√≥ egyik legszebb panor√°m√°j√∫ partszakasza Pilatus √©s Rigi sziluettj√©vel.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi01.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/qVwd7QesC7BEzXRJ7" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_01_Vierwaldstattersee_Meggen.jpg" alt="Vierwaldst√§ttersee, Meggen">
        </div>

        <!-- P2 -->
        <div class="poi" id="p2">
          <div class="poi-head">
            <div class="poi-title">2. Zugersee, Cham</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p2"></span><span data-badgetext="p2">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p2">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Kisebb, intimebb t√≥ er≈ës hegyi h√°tt√©rrel, rendezett t√≥parti s√©t√°nyokkal.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi02.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/efHrsLKNABsVVf798" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_02_Zugersee_Cham.jpg" alt="Zugersee, Cham">
        </div>

        <!-- P3 -->
        <div class="poi" id="p3">
          <div class="poi-head">
            <div class="poi-title">3. Hirzel h√°g√≥</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p3"></span><span data-badgetext="p3">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p3">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Szel√≠d gerinc√°tvezet√©s a t√≥r√©gi√≥ √©s a keleti hegyvid√©k fel√©, tany√°s t√°jjal.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi03.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/8tA8ciJLeRmCGZcb7" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_03_Hirzelpass.jpg" alt="Hirzel h√°g√≥">
        </div>

        <!-- P4 -->
        <div class="poi" id="p4">
          <div class="poi-head">
            <div class="poi-title">4. Z√ºrichsee, Seedamm</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p4"></span><span data-badgetext="p4">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p4">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">√Åtkel√©s a t√≥ legkeskenyebb r√©sz√©n Pf√§ffikon √©s Rapperswil k√∂z√∂tt, v√≠z k√©t oldalon.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi04.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/9VFDu6945xFeSbm98" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_04_Zurichsee_Seedamm.jpg" alt="Z√ºrichsee, Seedamm">
        </div>

        <!-- P5 -->
        <div class="poi" id="p5">
          <div class="poi-head">
            <div class="poi-title">5. Rapperswil v√°ra</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p5"></span><span data-badgetext="p5">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p5">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">K√∂z√©pkori v√°r dombtet≈ën, r√≥zsakertek √©s teljes panor√°ma a Z√ºrichi t√≥ medenc√©j√©re.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi05.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://www.google.com/maps?q=47.22735016586741,8.816564295120928" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_05_Rapperswil_Vara.jpg" alt="Rapperswil v√°ra">
        </div>

        <!-- P6 -->
        <div class="poi" id="p6">
          <div class="poi-head">
            <div class="poi-title">6. Ricken h√°g√≥</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p6"></span><span data-badgetext="p6">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p6">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">√Åtmenet a t√≥vid√©k √©s a Toggenburg fel√©, v√≠zv√°laszt√≥ jelleg≈± gerincszakasz.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi06.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/jzbuMiVuu1C99N1v8" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_06_Rickenpass.jpg" alt="Ricken h√°g√≥">
        </div>

        <!-- P7 -->
        <div class="poi" id="p7">
          <div class="poi-head">
            <div class="poi-title">7. Thur v√∂lgye, Toggenburg</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p7"></span><span data-badgetext="p7">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p7">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Karakteres alpesi v√∂lgy a Churfirsten fogazott cs√∫csaival √©s fiatal hegyi foly√≥val.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi07.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/1EWSQGngxH3oUU4aA" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_07_Thur_Toggenburg.jpg" alt="Thur v√∂lgye, Toggenburg">
        </div>

        <!-- P8 -->
        <div class="poi" id="p8">
          <div class="poi-head">
            <div class="poi-title">8. Wildhaus h√°g√≥</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p8"></span><span data-badgetext="p8">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p8">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Hegyi fenns√≠k jelleg≈± magasabb r√©gi√≥, v√≠zv√°laszt√≥ a Thur √©s a Rajna v√∂lgye k√∂z√∂tt.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi08.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/fnr3kdZfPa1rwxcn7" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_08_Wildhauspass.jpg" alt="Wildhaus h√°g√≥">
        </div>

        <!-- P9 -->
        <div class="poi" id="p9">
          <div class="poi-head">
            <div class="poi-title">9. Arlberg h√°g√≥, Arlbergpass</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p9"></span><span data-badgetext="p9">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p9">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Keleti alpesi √°tj√°r√≥ Tirol √©s Vorarlberg k√∂z√∂tt, er≈ës t√°jv√°lt√°ssal √©s hegyi ritmussal.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi09.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/VyHCweWNPUSJgYsM7" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_09_Arlbergpass.jpg" alt="Arlberg h√°g√≥, Arlbergpass">
        </div>

        <!-- P10 -->
        <div class="poi" id="p10">
          <div class="poi-head">
            <div class="poi-title">10. Schloss Landeck</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p10"></span><span data-badgetext="p10">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p10">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Sziklaszirten √°ll√≥ v√°r az Inn v√∂lgye felett, term√©szetes csom√≥ponti r√°l√°t√°ssal.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi10.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/sUu4Zzq6Dm4r7Jsw5" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_10_Schloss_Landeck.jpg" alt="Schloss Landeck">
        </div>

        <!-- P11 -->
        <div class="poi" id="p11">
          <div class="poi-head">
            <div class="poi-title">11. Stamsi ap√°ts√°g, Stift Stams</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p11"></span><span data-badgetext="p11">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p11">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">K√∂z√©pkori kolostor az Inn v√∂lgy√©ben, a t√°jhoz illeszked≈ë v√∂lgyfen√©ki k√∂zpont.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi11.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/cQ5ZqqDC48TpM6zq8" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_11_Stift_Stams.jpg" alt="Stamsi ap√°ts√°g, Stift Stams">
        </div>

        <!-- P12 -->
        <div class="poi" id="p12">
          <div class="poi-head">
            <div class="poi-title">12. Martinswand, Zirl</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p12"></span><span data-badgetext="p12">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p12">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Monument√°lis, f√ºgg≈ëleges sziklafal az Inn v√∂lgy√©ben, I. Miksa legend√°j√°val.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi12.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/wL5qiXc9uoXmbUmy8" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_12_Martinswand_Zirl.jpg" alt="Martinswand, Zirl">
        </div>

        <!-- P13 -->
        <div class="poi" id="p13">
          <div class="poi-head">
            <div class="poi-title">13. Goldenes Dachl, Innsbruck</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p13"></span><span data-badgetext="p13">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p13">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Innsbruck ikonja, aranyozott r√©zlemezekkel fedett erk√©ly az √≥v√°rosban, most referencia pont.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi13.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/vNpHh8supMEhbSeNA" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_13_Goldenes_Dachl_Innsbruck.jpg" alt="Goldenes Dachl, Innsbruck">
        </div>

        <!-- P14 -->
        <div class="poi" id="p14">
          <div class="poi-head">
            <div class="poi-title">14. Swarovski Krist√°lyvil√°g, Wattens</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p14"></span><span data-badgetext="p14">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p14">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Vil√°gh√≠r≈± krist√°ly√©lm√©nyk√∂zpont, Andr√© Heller √ìri√°s bej√°rat√°val √©s l√°tv√°nyos terek vil√°g√°val.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi14.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/JuXnntnD6GP5qw8c9" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_14_Swarovski_Kristalyvilag_Wattens.jpg" alt="Swarovski Krist√°lyvil√°g, Wattens">
        </div>

        <!-- P15 -->
        <div class="poi" id="p15">
          <div class="poi-head">
            <div class="poi-title">15. Tratzberg kast√©ly</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p15"></span><span data-badgetext="p15">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p15">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">Renesz√°nsz kast√©ly az Inn v√∂lgye feletti hegyoldalban, er≈ës t√∂meg √©s t√°jba √°gyazotts√°g.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi15.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/VtoLma7JdVq73eLx8" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_15_Tratzberg_Kastely.jpg" alt="Tratzberg kast√©ly">
        </div>

        <!-- P16 -->
        <div class="poi" id="p16">
          <div class="poi-head">
            <div class="poi-title">16. Campingdorf Hofer, Hippach</div>
            <div class="badges">
              <span class="badge"><span class="dot warn" data-dot="p16"></span><span data-badgetext="p16">m√©r√©s: v√°rakoz√°s</span></span>
              <span class="badge"><span class="dot warn"></span><span data-dist="p16">t√°vols√°g: ‚Äî</span></span>
            </div>
          </div>
          <div class="p">V√©g√°llom√°s a Ziller v√∂lgy√©ben, stabil b√°zispont a Zillertal n√©pszer≈± alpesi r√©gi√≥j√°ban.</div>
          <div class="poibtns">
            <a class="btn btn-accent" href="poi16.html">R√©szletek</a>
            <a class="btn btn-blue" href="https://maps.app.goo.gl/Bq5xLiRnXUScJALe9" target="_blank" rel="noopener">üß≠ Navig√°ci√≥</a>
          </div>
          <img class="inline-image" src="images/DAY07_16_Campingdorf_Hofer_Hippach.jpg" alt="Campingdorf Hofer, Hippach">
        </div>

      </div>

      <!-- T√âRK√âP AZ OLDAL ALJ√ÅN (CSAK HOZZ√ÅADVA) -->
      <div style="height:16px"></div>
      <div class="card">
        <div class="h1">T√©rk√©p</div>
        <div id="map" style="width:100%; height:360px; border-radius:12px;"></div>
      </div>

    </div>
  </div>

  <script>
    const POIS = [
      { id: "p1",  lat: 47.045861,            lon: 8.372866 },
      { id: "p2",  lat: 47.143251,            lon: 8.455585 },
      { id: "p3",  lat: 47.213433,            lon: 8.598525 },
      { id: "p4",  lat: 47.217070,            lon: 8.805522 },
      { id: "p5",  lat: 47.22735016586741,   lon: 8.816564295120928 },
      { id: "p6",  lat: 47.260364,            lon: 9.032927 },
      { id: "p7",  lat: 47.284421,            lon: 9.091034 },
      { id: "p8",  lat: 47.20335633763527,   lon: 9.350429885265918 },
      { id: "p9",  lat: 47.129501,            lon: 10.210870 },
      { id: "p10", lat: 47.140677,            lon: 10.563858 },
      { id: "p11", lat: 47.280754,            lon: 10.982960 },
      { id: "p12", lat: 47.267209,            lon: 11.271552 },
      { id: "p13", lat: 47.269524,            lon: 11.390778 },
      { id: "p14", lat: 47.295353,            lon: 11.601764 },
      { id: "p15", lat: 47.375956,            lon: 11.750438 },
      { id: "p16", lat: 47.228658,            lon: 11.886396 }
    ];

    function haversineKm(lat1, lon1, lat2, lon2) {
      const R = 6371;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a =
        Math.sin(dLat / 2) ** 2 +
        Math.cos(lat1 * Math.PI / 180) *
        Math.cos(lat2 * Math.PI / 180) *
        Math.sin(dLon / 2) ** 2;
      return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    }

    function setBadge(id, txt) {
      const el = document.querySelector(`[data-badgetext="${id}"]`);
      if (el) el.textContent = txt;
    }

    function setDist(id, km) {
      const el = document.querySelector(`[data-dist="${id}"]`);
      if (el) el.textContent = `t√°vols√°g: ${km.toFixed(2)} km`;
    }

    function setDotOk(id) {
      const el = document.querySelector(`[data-dot="${id}"]`);
      if (el) {
        el.classList.remove("warn");
        el.classList.add("ok");
      }
    }

    function computeDistances(pos) {
      const out = {};
      POIS.forEach(p => {
        out[p.id] = haversineKm(pos.lat, pos.lon, p.lat, p.lon);
      });
      return out;
    }

    function scrollToPoi(id) {
      const el = document.getElementById(id);
      if (el) el.scrollIntoView({ behavior: "smooth", block: "center" });
    }

    function getPosOnce() {
      return new Promise((resolve, reject) => {
        navigator.geolocation.getCurrentPosition(
          p => resolve({ lat: p.coords.latitude, lon: p.coords.longitude }),
          e => reject(e),
          { enableHighAccuracy: true, maximumAge: 0, timeout: 12000 }
        );
      });
    }

    async function runMeasureCycle(scrollAfter = true) {
      try {
        const pos = await getPosOnce();
        const d = computeDistances(pos);

        for (const id in d) {
          setDist(id, d[id]);
          setBadge(id, "m√©rve");
          setDotOk(id);
        }

        if (scrollAfter) {
          const nearest = Object.keys(d).reduce((a, b) => d[a] < d[b] ? a : b);
          scrollToPoi(nearest);
        }
      } catch (err) {
        const n = document.getElementById("gpsNotice");
        if (n) n.style.display = "block";
      }
    }

    runMeasureCycle(true);
    setTimeout(() => runMeasureCycle(false), 5000);

    document.getElementById("btnNearest").addEventListener("click", () => runMeasureCycle(true));

    // T√âRK√âP LOGIKA (CSAK HOZZ√ÅADVA) + SZ√ÅMOZOTT K√âK POI-JEL√ñL≈êK + PIROS SAJ√ÅT HELY
    let map;

    function blueNumberIcon(n) {
      const svg = `
<svg xmlns="http://www.w3.org/2000/svg" width="30" height="46" viewBox="0 0 30 46">
  <path d="M15 0C8 0 2.5 5.5 2.5 12.5C2.5 23 15 46 15 46C15 46 27.5 23 27.5 12.5C27.5 5.5 22 0 15 0Z"
        fill="#2A81CB" stroke="rgba(0,0,0,0.35)" stroke-width="1"/>
  <text x="15" y="18" text-anchor="middle"
        font-family="system-ui, -apple-system, Segoe UI, Roboto, Arial"
        font-size="13" font-weight="800"
        fill="#ff2b2b" stroke="#ffffff" stroke-width="2" paint-order="stroke">${n}</text>
</svg>`;
      return L.divIcon({
        className: "poi-numbered-icon",
        html: svg,
        iconSize: [30, 46],
        iconAnchor: [15, 46],
        popupAnchor: [0, -38]
      });
    }

    function getPoiTitle(id) {
      const el = document.querySelector(`#${id} .poi-title`);
      return el ? el.textContent.trim() : id;
    }

    function initMap(userPos) {
      map = L.map("map");

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "¬© OpenStreetMap"
      }).addTo(map);

      const bounds = [];

      POIS.forEach(p => {
        const num = parseInt(String(p.id).replace("p", ""), 10);
        const safeNum = Number.isFinite(num) ? num : "";
        const title = getPoiTitle(p.id);

        L.marker([p.lat, p.lon], { icon: blueNumberIcon(safeNum) })
          .addTo(map)
          .bindPopup(title);

        bounds.push([p.lat, p.lon]);
      });

      if (userPos) {
        const redIcon = L.icon({
          iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",
          shadowUrl: "https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",
          iconSize: [25, 41],
          iconAnchor: [12, 41],
          popupAnchor: [1, -34],
          shadowSize: [41, 41]
        });

        L.marker([userPos.lat, userPos.lon], { icon: redIcon })
          .addTo(map)
          .bindPopup("üìç Itt vagyok");

        bounds.push([userPos.lat, userPos.lon]);
      }

      if (bounds.length) {
        map.fitBounds(bounds, { padding: [30, 30] });
      }
    }

    getPosOnce()
      .then(pos => initMap(pos))
      .catch(() => initMap(null));
  </script>

</body>
</html>
